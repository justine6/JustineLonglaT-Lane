param(
  [switch]$PromoteOnly  # use if you already have a fresh preview URL
)

# Ensure team scope
vercel switch | Out-Null

function Get-PreviewUrl {
  $out = vercel --yes
  $m = ($out | Select-String 'https://.*\.vercel\.app').Matches
  if (-not $m -or $m.Count -eq 0) { throw "Could not find a preview URL in Vercel output." }
  return $m[0].Value
}

if ($PromoteOnly) {
  Write-Host "Provide a preview URL to promote: " -NoNewline
  $url = Read-Host
} else {
  $url = Get-PreviewUrl
  Write-Host "Preview: $url"
}

vercel promote $url --prod --yes
Write-Host "âœ… Promoted to production."
